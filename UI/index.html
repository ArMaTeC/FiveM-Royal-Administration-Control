<!DOCTYPE html>
<html>
	<head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="CSS/style.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
 <!-- <style>#admin,#exist { display: none; }</style> -->
		

		<script>
			let selected = 0;
			$(function(){
				$(document).keyup(function(e) {
					if(e.keyCode == 27){
						$("#admin").css('display', 'none')
						$.post('http://es_admin2/close', JSON.stringify({}));
					}
				})
				window.addEventListener('message', function(event) {
					if(event.data.type == "open"){
						$('#notexist').css('display', 'block')
						$('#exist').css('display', 'none')
						$("#admin").css('display', "block")
						$('input').val("")

						$('#list').empty()
						for(let i in event.data.players){
							let player = event.data.players[i];
							$('#list').append('<div class="player" id="player_' + player.id + '">' + player.name + '</div>')
						}
						$(".player").click(function(){
							let id = $(this).attr('id').replace('player_', '')
							selected = parseInt(id)

							$('.player').removeClass('selected')
							$(this).addClass('selected')

							$('#exist').find('h1').text(selected + ", " + $(this).text())

							$('#notexist').css('display', 'none')
							$('#exist').css('display', 'block')
                        })
                        // commands list
                        $('#listcmd').empty()
						for(let i in event.data.commands){
							let command = event.data.commands[i];
							$('#listcmd').append('<div class="command" id="command_' + command.id + '">' + command.name + '</div>')
						}
						$(".command").click(function(){
							let id = $(this).attr('id').replace('command_', '')
							selected = parseInt(id)

							$('.command').removeClass('selected')
							$(this).addClass('selected')

							$('#exist').find('h1').text(selected + ", " + $(this).text())

							$('#notexist').css('display', 'none')
							$('#exist').css('display', 'block')
						})
					}
				});

				$("#close").click(() => {
					$("#admin").css('display', 'none')
					$.post('http://es_admin2/close', JSON.stringify({}));
				});

				var lastTabUsed = null;
				function createTab(id, name) 
				{
					var btn = document.createElement('button');
					btn.id = id;
					btn.innerHTML = name;
					$(btn).addClass("tab");
					var tabsLoaded = $('#tabs').children.length
					if (tabsLoaded == 0)
					{
						$(btn).addClass('selected');
					}
					$("#tabs").append(btn);

					var div = $("#" + id + "-content");
					div.css("display", "none");
					$(btn).click(() => {
						div.css('display', 'block');

						$(btn).addClass("selected");
						$(btn).blur();
						if (lastTabUsed != null && $(lastTabUsed).attr('id') != $(btn).attr('id'))
						{
							var lastDiv = $('#' + $(lastTabUsed).attr('id') + "-content");
							lastDiv.css('display', 'none');
							console.log(lastDiv);
							$(lastTabUsed).removeClass("selected");
						}
						lastTabUsed = $(btn);
					});
				};

				function createSideBarParent(id, name, target)
				{
					var btn = document.createElement('button');
					btn.id = id;
					btn.innerHTML = name;
					$(btn).addClass('dropdown-btn');

					var caret = document.createElement('i');
					$(caret).addClass('fa');
					$(caret).addClass('fa-caret-down');
					$(btn).append(caret);

					$(target).append(btn);

					var content = document.createElement('div');
					$(content).addClass("dropdown-content");
					$(target).append(content);

					return $(content);
				};
				var lastSideBarBtn = null;
				function createSidebarPageBtn(id, name, content)
				{
					console.log(content);
					var btn = document.createElement('button');
					//$(btn).addClass('tab');
					btn.id = id;
					btn.innerHTML = name;

					$(content).append(btn);

					var div = $("#" + id + "-cmd-content");
					div.css("display", "none");
					$(btn).click(() => {
						div.css('display', 'block');

						$(btn).addClass("selected");
						$(btn).blur();
						if (lastSideBarBtn != null && $(lastSideBarBtn).attr('id') != $(btn).attr('id'))
						{
							var lastDiv = $('#' + $(lastSideBarBtn).attr('id') + "-cmd-content");
							lastDiv.css('display', 'none');
							$(lastSideBarBtn).removeClass("selected");
						}
						lastSideBarBtn = $(btn);
					});
				};

				createTab("commands", "Commands");
				createTab("groups", "Groups");
				createTab("server", "Server");
				
				var cmdlist = $('#listcmd');

				var admin = createSideBarParent("admin", "Admin", cmdlist);
				createSidebarPageBtn('kick', "kick", admin);
				createSidebarPageBtn('ban', "ban", admin);

				var teleportation = createSideBarParent("teleportation", "Teleportation", cmdlist);
				createSidebarPageBtn('goto', "goto", teleportation);
				createSidebarPageBtn('bring', "bring", teleportation);

				/*
				$("#slay_all").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'slay_all'})); $(this).blur()})
				$("#bring_all").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'bring_all'})); $(this).blur()})
				$("#slap_all").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'slap_all'})); $(this).blur()})


				$("#slay").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'slay'})); $(this).blur()})
				$("#kick").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'kick'})); $(this).blur()})
				$("#noclip").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'noclip'})); $(this).blur()})
				$("#freeze").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'freeze'})); $(this).blur()})
				$("#bring").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'bring'})); $(this).blur()})
				$("#goto").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'goto'})); $(this).blur()})
				$("#slap").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'slap'})); $(this).blur()})
				$("#crash").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'crash'})); $(this).blur()})
				$("#ban").click(function() {$.post('http://es_admin2/quick', JSON.stringify({id: selected, type: 'ban'})); $(this).blur()})
				$("#setgroup").click(function() {$.post('http://es_admin2/set', JSON.stringify({user: selected, type: 'group', param: $("#newgroup").val()})); $(this).blur()})
				$("#setlevel").click(function() {$.post('http://es_admin2/set', JSON.stringify({user: selected, type: 'level', param: $("#newlevel").val()})); $(this).blur()})
				$("#setmoney").click(function() {$.post('http://es_admin2/set', JSON.stringify({user: selected, type: 'money', param: $("#newmoney").val()})); $(this).blur()})
				$("#setbank").click(function() {$.post('http://es_admin2/set', JSON.stringify({user: selected, type: 'bank', param: $("#newbank").val()})); $(this).blur()})
				*/
				$('button').click(function() {$(this).blur()});
			});
        </script>
        <script>
            /* Loop through all dropdown buttons to toggle between hiding and showing its dropdown content - This allows the user to have multiple dropdowns without any conflict */
            $(function(){
                var dropdown = document.getElementsByClassName("dropdown-btn");
                var i;
                
                for (i = 0; i < dropdown.length; i++) {
                    dropdown[i].addEventListener("click", function() {
                        this.classList.toggle("active");
                        var dropdownContent = this.nextElementSibling;
                        if (dropdownContent.style.display === "block") {
                            dropdownContent.style.display = "none";
                        } else {
                            dropdownContent.style.display = "block";
                        }
                    });
                }
            });    
        </script>
	</head>
	<body>
		<div class="ui">
			<div class="topbar">
				<p>Royal Admin Control</p>
				<div id="close">&#10060;</div>
			</div>

			<div id="tabs">
			</div>

			<div id="main">
				<div id="commands-content">
					<div style="float: left;">
						<div class="list">
							<div class="sidenav" id='listcmd'>
							</div>    
						</div>
					</div>
					<div>
						<div id="goto-cmd-content">
							Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ultricies, massa eu consequat maximus, neque elit euismod enim, in rhoncus ante mauris ac felis. Sed vitae leo justo. Proin ullamcorper sapien eget sodales viverra. Nunc molestie mollis erat ut pretium. Cras ut est dictum, suscipit ipsum ac, tempor magna. Vestibulum interdum, orci vel dictum consectetur, diam enim porttitor erat, porttitor sollicitudin neque dui non leo. Pellentesque maximus venenatis fermentum. Quisque quis iaculis orci. Curabitur consectetur, lacus id convallis molestie, turpis mauris mollis enim, at sagittis nunc urna eu nulla. Sed rhoncus ante ac est blandit, in maximus ipsum vulputate. Donec lectus lectus, suscipit sit amet neque a, tristique viverra mauris. Duis mattis laoreet ex, at dapibus dui pharetra tempus. Sed at est in sem volutpat auctor.

							Integer tempor faucibus rutrum. Fusce id aliquam magna, vitae facilisis nunc. Etiam porttitor aliquam turpis a pharetra. Maecenas vestibulum ut quam sit amet condimentum. Nulla commodo aliquet odio, mollis tincidunt sapien dapibus ut. Ut sodales felis nisl, vitae porttitor mauris aliquam eu. Curabitur porttitor risus vitae sem venenatis dictum.
							
							Aliquam erat volutpat. Proin vestibulum neque vitae orci egestas, sed iaculis ipsum luctus. Aliquam dignissim metus nec congue fermentum. Mauris mattis ullamcorper tristique. Nulla molestie libero a augue venenatis, nec posuere dui ornare. Vestibulum lacus nunc, hendrerit eu volutpat quis, faucibus quis mauris. Mauris consectetur justo tortor. Duis tempor sodales sem, eu elementum enim. Quisque porta commodo massa non fermentum.
							
							Maecenas in dui felis. Aliquam vestibulum nulla at erat pharetra viverra. Sed at porta augue. In volutpat et neque at laoreet. Maecenas urna odio, lacinia eu mi ac, fringilla molestie urna. Integer tincidunt porttitor enim et condimentum. In dapibus, quam id efficitur mollis, nibh enim ultrices velit, eu dignissim risus nunc vel turpis. Mauris augue libero, euismod vitae scelerisque sit amet, elementum sed tortor. Mauris at massa convallis, condimentum orci eget, euismod sem.
							
							In ac auctor odio. Suspendisse sed molestie leo, ut pretium eros. In dapibus vel nisi eu consequat. Curabitur justo mauris, sollicitudin id ex eget, blandit dapibus quam. Vivamus accumsan, orci nec tincidunt commodo, purus nulla dictum mi, at imperdiet mauris urna ac ex. Interdum et malesuada fames ac ante ipsum primis in faucibus. Proin nulla ex, varius vel nisi eget, lacinia gravida turpis. Fusce vel lorem eu nibh euismod condimentum. Nam congue urna massa, ut convallis odio tincidunt in. Nam tristique tellus at metus congue laoreet. Maecenas semper ante et massa lacinia, non iaculis magna dignissim. Integer vel vestibulum metus. Praesent tristique purus lobortis, pellentesque est vestibulum, iaculis erat. Nullam at erat purus. Sed scelerisque ante blandit, finibus mauris at, convallis leo. Aenean placerat sed enim at commodo.
						</div>
					</div>
				</div>
				<div id="server-content">
					<h3>Server Options</h3>
                </div>
                <div id="groups-content">
					<h3>Groups</h3>
					
                    <div class="group_set">
                        <label>Group</label>
                        <input id="newgroup" type="text" placeholder="new group"/>
                        <button id="setgroup">Set</button>
                    </div>
				</div>
			</div>
		</div>
	</body>
</html>